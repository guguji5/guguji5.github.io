import{a4 as e,r as t,b as a,a1 as n,x as l,T as i}from"./vendor.6a8dc018.js";import{a8 as r,P as s,c as m}from"./index.366ccd84.js";import{a as c}from"./index.e28e6ead.js";/* empty css              */const o=()=>{const{id:o}=e();t.useState(null);const[d,u]=t.useState(),v=a();t.useEffect((()=>{r(o).then((e=>{e.dat&&(u(e.dat),e.dat)}))}),[o]);const p=[{title:"时间",dataIndex:"t",render:e=>t.createElement(t.Fragment,null,l(1e3*e).format("YYYY-MM-DD HH:mm:ss"))},{title:"值",dataIndex:"v"}];return t.createElement(s,{showBack:!0,title:"告警详情"},t.createElement("div",{className:"event-detail-content"},t.createElement("div",{className:"event-detail-content-main"},t.createElement("div",null,t.createElement("span",{className:"event-detail-content-main-label"},"策略名称:")," ",t.createElement("span",{className:n("event-detail-content-main-active"),onClick:()=>v.push(`/strategy/edit/${null==d?void 0:d.rule_id}`)},null==d?void 0:d.rule_name)),t.createElement("div",null,t.createElement("span",{className:"event-detail-content-main-label"},"状态:")," P",null==d?void 0:d.priority),t.createElement("div",null,t.createElement("span",{className:"event-detail-content-main-label"},"通知结果:")," ",c.Enable===(null==d?void 0:d.status)?"已触发":"已屏蔽"),d&&t.createElement("div",null,t.createElement("span",{className:"event-detail-content-main-label"},"发生时间:"),l(1e3*d.trigger_time||0).format("YYYY-MM-DD HH:mm:ss")),(null==d?void 0:d.res_classpaths)&&t.createElement("div",null,t.createElement("span",{className:"event-detail-content-main-label"},"资源分组:")," ",null==d?void 0:d.res_classpaths),(null==d?void 0:d.res_ident)&&t.createElement("div",null,t.createElement("span",{className:"event-detail-content-main-label"},"资源标识:")," ",null==d?void 0:d.res_ident),(null==d?void 0:d.tags)&&t.createElement("div",null,t.createElement("span",{className:"event-detail-content-main-label"},"标签:")," ",null==d?void 0:d.tags),(null==d?void 0:d.runbook_url)&&t.createElement("div",null,t.createElement("span",{className:"event-detail-content-main-label"},"预案手册:")," ",null==d?void 0:d.runbook_url),(null==d?void 0:d.rule_note)&&t.createElement("div",null,t.createElement("span",{className:"event-detail-content-main-label"},"备注:")," ",null==d?void 0:d.rule_note),(null==d?void 0:d.readable_expression)&&t.createElement("div",null,t.createElement("span",{className:"event-detail-content-main-label"},"表达式:")," ",null==d?void 0:d.readable_expression),null==d?void 0:d.history_points.map(((e,a)=>{const{metric:n,tags:r}=e;console.log(Object.keys((e=>({key:e,value:r[e]}))));let s={limit:50,metric:n,xplotline:d.trigger_time,tags:Object.keys(r).map((e=>({key:e,value:r[e]}))),range:l().subtract(1,"hour").unix()>d.trigger_time?{start:l(1e3*d.trigger_time).subtract(1,"hour").unix(),end:l(1e3*d.trigger_time).add(1,"hour").unix()}:{start:l(1e3*d.trigger_time).subtract(2,"hour").unix(),end:d.trigger_time}};return d.is_prome_pull&&(s.prome_ql=d.readable_expression),t.createElement("div",{key:a,className:"event-detail-content-main-chart-and-table"},e.metric&&t.createElement("div",null,t.createElement("span",{style:{width:"60px"}},"现场值:"),e.metric),t.createElement(i,{columns:p,rowKey:"t",pagination:!1,dataSource:e.points||[]}),t.createElement(m,{title:e.metric||d.readable_expression,options:s}))})))))};export default o;export{o as Detail};
